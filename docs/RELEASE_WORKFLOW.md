# è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬å¿«é€Ÿå‘å¸ƒæ–°ç‰ˆæœ¬ã€‚

---

## ğŸš€ å¿«é€Ÿå‘å¸ƒï¼ˆæ¨èï¼‰

### æ–¹å¼ 1ï¼šä½¿ç”¨å½“å‰ç‰ˆæœ¬å‘å¸ƒ

```bash
npm run release
```

è¿™ä¼šï¼š
1. è¯»å– `package.json` ä¸­çš„å½“å‰ç‰ˆæœ¬
2. åˆ›å»ºå¯¹åº”çš„ git tagï¼ˆä¾‹å¦‚ `v1.0.0`ï¼‰
3. æ¨é€åˆ° GitHub
4. è§¦å‘è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒ

### æ–¹å¼ 2ï¼šå‘å¸ƒæ–°ç‰ˆæœ¬

```bash
npm run release:version 1.1.0
```

è¿™ä¼šï¼š
1. æ›´æ–° `package.json` ç‰ˆæœ¬ä¸º `1.1.0`
2. æäº¤ç‰ˆæœ¬æ›´æ”¹
3. åˆ›å»º tag `v1.1.0`
4. æ¨é€åˆ° GitHub
5. è§¦å‘è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒ

### æ–¹å¼ 3ï¼šå¸¦è‡ªå®šä¹‰æ¶ˆæ¯å‘å¸ƒ

**Windows (PowerShell)**:
```powershell
.\scripts\release\publish-electron.ps1 -Version "1.1.0" -Message "feat: æ·»åŠ è‡ªåŠ¨æ›´æ–°åŠŸèƒ½"
```

**Mac/Linux**:
```bash
./scripts/release/publish-electron.sh -v 1.1.0 -m "feat: æ·»åŠ è‡ªåŠ¨æ›´æ–°åŠŸèƒ½"
```

---

## ğŸ“‹ å‘å¸ƒæµç¨‹è¯¦è§£

### 1. æœ¬åœ°å‡†å¤‡

```bash
# ç¡®ä¿ä»£ç å·²æäº¤
git status

# è¿è¡Œæµ‹è¯•ï¼ˆå¦‚æœæœ‰ï¼‰
npm run type-check
npm run lint

# æ¸…ç†å¹¶é‡æ–°æ„å»ºï¼ˆå¯é€‰ï¼‰
npm run clean:build
```

### 2. æ‰§è¡Œå‘å¸ƒ

```bash
# æ–¹å¼ 1: ä½¿ç”¨ npm å‘½ä»¤
npm run release

# æ–¹å¼ 2: ç›´æ¥è¿è¡Œè„šæœ¬
pwsh -ExecutionPolicy Bypass -File ./scripts/release/publish-electron.ps1
```

### 3. è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œ

âœ… æ£€æŸ¥ `package.json` ç‰ˆæœ¬  
âœ… æ£€æµ‹æœªæäº¤çš„æ›´æ”¹ï¼ˆå¦‚æœ‰ï¼Œä¼šæç¤ºæ˜¯å¦æäº¤ï¼‰  
âœ… åˆ›å»º git tag  
âœ… æ¨é€ä»£ç å’Œ tag åˆ° GitHub  
âœ… è§¦å‘ GitHub Actions æ„å»º  

### 4. GitHub Actions è‡ªåŠ¨å®Œæˆ

GitHub Actions ä¼šè‡ªåŠ¨ï¼š
1. **å¹¶è¡Œæ„å»ºä¸‰ä¸ªå¹³å°**
   - Windows (NSIS å®‰è£…åŒ… + ä¾¿æºç‰ˆ)
   - macOS (DMG + ZIP)
   - Linux (AppImage + DEB)

2. **åˆ›å»º GitHub Release**
   - ä½¿ç”¨ tag åç§°ä½œä¸º Release åç§°
   - è‡ªåŠ¨ç”Ÿæˆ Release Notes

3. **ä¸Šä¼ æ‰€æœ‰å®‰è£…åŒ…**
   - æ‰€æœ‰æ„å»ºäº§ç‰©è‡ªåŠ¨ä¸Šä¼ 
   - åŒ…æ‹¬æ›´æ–°å…ƒæ•°æ®æ–‡ä»¶ï¼ˆ`latest.yml` ç­‰ï¼‰

**æ„å»ºæ—¶é—´**ï¼šçº¦ 10-15 åˆ†é’Ÿ

---

## ğŸ” æŸ¥çœ‹æ„å»ºçŠ¶æ€

### GitHub Actions é¡µé¢
```
https://github.com/papalqi/utility-tool/actions
```

### æ„å»ºå®Œæˆå
```
https://github.com/papalqi/utility-tool/releases
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)ï¼š

- **ä¸»ç‰ˆæœ¬å· (Major)**ï¼šä¸å…¼å®¹çš„ API ä¿®æ”¹
  ```bash
  1.0.0 â†’ 2.0.0
  ```

- **æ¬¡ç‰ˆæœ¬å· (Minor)**ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
  ```bash
  1.0.0 â†’ 1.1.0
  ```

- **ä¿®è®¢å· (Patch)**ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£
  ```bash
  1.0.0 â†’ 1.0.1
  ```

### 2. Tag å‘½å

- âœ… æ­£ç¡®ï¼š`v1.0.0`, `v1.1.0`, `v2.0.0`
- âŒ é”™è¯¯ï¼š`1.0.0`, `release-1.0.0`, `V1.0.0`

å¿…é¡»ä»¥å°å†™ `v` å¼€å¤´ï¼

### 3. é¦–æ¬¡å‘å¸ƒå‰

ç¡®ä¿ `package.json` ä¸­çš„ä»“åº“åœ°å€æ­£ç¡®ï¼š

```json
{
  "repository": {
    "type": "git",
    "url": "https://github.com/papalqi/utility-tool.git"
  }
}
```

### 4. æƒé™è¦æ±‚

- ä»“åº“éœ€è¦å¯ç”¨ **GitHub Actions**
- éœ€è¦ **å†™å…¥ Releases** æƒé™ï¼ˆé»˜è®¤å·²æœ‰ï¼‰

---

## ğŸ› ï¸ æ‰‹åŠ¨å‘å¸ƒï¼ˆä¸æ¨èï¼‰

å¦‚æœè‡ªåŠ¨åŒ–è„šæœ¬å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨å‘å¸ƒï¼š

### 1. æ›´æ–°ç‰ˆæœ¬
```bash
# æ‰‹åŠ¨ç¼–è¾‘ package.json
# "version": "1.1.0"

# æˆ–ä½¿ç”¨ npm
npm version 1.1.0 --no-git-tag-version
```

### 2. æäº¤æ›´æ”¹
```bash
git add package.json
git commit -m "chore: release v1.1.0"
```

### 3. åˆ›å»º tag
```bash
git tag -a v1.1.0 -m "Release v1.1.0"
```

### 4. æ¨é€
```bash
git push origin main
git push origin v1.1.0
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: è„šæœ¬æ— æ³•æ‰§è¡Œ

**Windows PowerShell é”™è¯¯**ï¼š
```
æ— æ³•åŠ è½½æ–‡ä»¶ï¼Œå› ä¸ºåœ¨æ­¤ç³»ç»Ÿä¸Šç¦æ­¢è¿è¡Œè„šæœ¬
```

**è§£å†³**ï¼š
```powershell
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned
```

### é—®é¢˜ 2: Tag å·²å­˜åœ¨

è„šæœ¬ä¼šæ£€æµ‹ tag å†²çªï¼Œå¹¶æç¤ºæ˜¯å¦åˆ é™¤æ—§ tagã€‚

**æ‰‹åŠ¨åˆ é™¤**ï¼š
```bash
# æœ¬åœ°åˆ é™¤
git tag -d v1.0.0

# è¿œç¨‹åˆ é™¤
git push origin :refs/tags/v1.0.0
```

### é—®é¢˜ 3: GitHub Actions æ„å»ºå¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- ä¾èµ–å®‰è£…å¤±è´¥
- æ„å»ºé”™è¯¯
- æƒé™é—®é¢˜

**æŸ¥çœ‹æ—¥å¿—**ï¼š
```
GitHub â†’ Actions â†’ ç‚¹å‡»å¤±è´¥çš„å·¥ä½œæµ â†’ æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
```

### é—®é¢˜ 4: Release åˆ›å»ºå¤±è´¥

**æ£€æŸ¥é¡¹**ï¼š
- `GITHUB_TOKEN` æ˜¯å¦æœ‰æƒé™ï¼ˆè‡ªåŠ¨æä¾›ï¼Œæ— éœ€é…ç½®ï¼‰
- ä»“åº“æ˜¯å¦ä¸º privateï¼ˆprivate ä»“åº“éœ€è¦ Pro è´¦å·ï¼‰
- æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®

---

## ğŸ“Š å®Œæ•´å‘å¸ƒæ£€æŸ¥æ¸…å•

å‘å¸ƒå‰æ£€æŸ¥ï¼š

- [ ] æ‰€æœ‰åŠŸèƒ½å·²å¼€å‘å®Œæˆ
- [ ] ä»£ç å·²é€šè¿‡ `npm run type-check`
- [ ] ä»£ç å·²é€šè¿‡ `npm run lint`
- [ ] æœ¬åœ°æµ‹è¯•æ— é—®é¢˜
- [ ] æ›´æ–°äº† CHANGELOGï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] æ›´æ–°äº†ç‰ˆæœ¬å·ï¼ˆå¦‚æœä½¿ç”¨ `release:version`ï¼‰
- [ ] æ‰€æœ‰æ›´æ”¹å·²æäº¤

æ‰§è¡Œå‘å¸ƒï¼š

- [ ] è¿è¡Œ `npm run release` æˆ– `npm run release:version <version>`
- [ ] ç¡®è®¤è„šæœ¬è¾“å‡ºæ— é”™è¯¯
- [ ] ç¡®è®¤ tag å·²æ¨é€åˆ° GitHub

å‘å¸ƒåéªŒè¯ï¼š

- [ ] GitHub Actions æ„å»ºæˆåŠŸ
- [ ] Release é¡µé¢æœ‰æ–°ç‰ˆæœ¬
- [ ] æ‰€æœ‰å¹³å°çš„å®‰è£…åŒ…å·²ä¸Šä¼ 
- [ ] `latest.yml` ç­‰å…ƒæ•°æ®æ–‡ä»¶å·²ä¸Šä¼ 
- [ ] ä¸‹è½½å¹¶æµ‹è¯•å®‰è£…åŒ…

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å‘å¸ƒèŠ‚å¥

- **Patch ç‰ˆæœ¬**ï¼šæ¯ 1-2 å‘¨å‘å¸ƒä¸€æ¬¡ï¼ˆBug ä¿®å¤ï¼‰
- **Minor ç‰ˆæœ¬**ï¼šæ¯ 1-2 ä¸ªæœˆå‘å¸ƒä¸€æ¬¡ï¼ˆæ–°åŠŸèƒ½ï¼‰
- **Major ç‰ˆæœ¬**ï¼šé‡å¤§æ›´æ–°æ—¶å‘å¸ƒï¼ˆç ´åæ€§æ›´æ”¹ï¼‰

### 2. å‘å¸ƒæ—¶æœº

å»ºè®®åœ¨å·¥ä½œæ—¥ç™½å¤©å‘å¸ƒï¼Œä¾¿äºï¼š
- åŠæ—¶å“åº”ç”¨æˆ·åé¦ˆ
- å¿«é€Ÿä¿®å¤ç´§æ€¥é—®é¢˜
- ç›‘æ§æ„å»ºè¿‡ç¨‹

### 3. Release Notes

GitHub Release ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä½†å»ºè®®æ‰‹åŠ¨ç¼–è¾‘ï¼š

**æ¨¡æ¿**ï¼š
```markdown
## ğŸ‰ æ–°åŠŸèƒ½
- æ·»åŠ è‡ªåŠ¨æ›´æ–°åŠŸèƒ½
- æ”¯æŒæ·±è‰²æ¨¡å¼

## ğŸ› Bug ä¿®å¤
- ä¿®å¤ç»ˆç«¯ç¼–ç é—®é¢˜
- ä¿®å¤æ–‡ä»¶ä¼ è¾“å¤±è´¥

## ğŸ“¦ ä¼˜åŒ–
- æå‡å¯åŠ¨é€Ÿåº¦
- å‡å°‘å†…å­˜å ç”¨

## âš ï¸ é‡è¦å˜æ›´
- é…ç½®æ–‡ä»¶æ ¼å¼å·²æ›´æ–°ï¼Œé¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨è¿ç§»
```

### 4. å›æ»šè®¡åˆ’

å¦‚æœæ–°ç‰ˆæœ¬æœ‰ä¸¥é‡é—®é¢˜ï¼š

```bash
# 1. åˆ é™¤æœ‰é—®é¢˜çš„ Releaseï¼ˆGitHub ç½‘é¡µæ“ä½œï¼‰

# 2. åˆ é™¤ tag
git tag -d v1.1.0
git push origin :refs/tags/v1.1.0

# 3. å›æ»šä»£ç 
git revert <commit-hash>

# 4. å‘å¸ƒä¿®å¤ç‰ˆæœ¬
npm run release:version 1.1.1
```

---

## ğŸ“ å‘å¸ƒè®°å½•ç¤ºä¾‹

| ç‰ˆæœ¬ | æ—¥æœŸ | ç±»å‹ | è¯´æ˜ |
|------|------|------|------|
| v1.0.0 | 2024-11-24 | Major | é¦–æ¬¡å‘å¸ƒ |
| v1.0.1 | 2024-11-25 | Patch | ä¿®å¤ç»ˆç«¯ç¼–ç é—®é¢˜ |
| v1.1.0 | 2024-11-26 | Minor | æ·»åŠ è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ |
| v1.1.1 | 2024-11-27 | Patch | ä¿®å¤æ›´æ–°æ£€æŸ¥å¤±è´¥ |
| v2.0.0 | 2024-12-01 | Major | é‡æ„é¡¹ç›®æ¶æ„ |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [AUTO_UPDATE_GUIDE.md](./AUTO_UPDATE_GUIDE.md) - è‡ªåŠ¨æ›´æ–°åŠŸèƒ½è¯´æ˜
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [electron-builder æ–‡æ¡£](https://www.electron.build/)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ](https://semver.org/lang/zh-CN/)

---

## ğŸ’¡ æç¤º

**ç¬¬ä¸€æ¬¡å‘å¸ƒ**ï¼š
```bash
# 1. ç¡®è®¤ç‰ˆæœ¬å·
cat package.json | grep version

# 2. è¿è¡Œå‘å¸ƒè„šæœ¬ï¼ˆä¼šæœ‰è¯¦ç»†æç¤ºï¼‰
npm run release

# 3. è§‚å¯Ÿ GitHub Actions æ„å»ºè¿‡ç¨‹
# 4. ç­‰å¾…æ„å»ºå®Œæˆï¼ˆçº¦ 10-15 åˆ†é’Ÿï¼‰
# 5. åœ¨ Releases é¡µé¢ç¡®è®¤
```

**åç»­å‘å¸ƒ**ï¼š
```bash
# å‡çº§ç‰ˆæœ¬å¹¶å‘å¸ƒï¼ˆä¸€æ¡å‘½ä»¤æå®šï¼‰
npm run release:version 1.1.0
```

å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ğŸ‰
